<!DOCTYPE html>
<html>
<head>
	<title>David J. Haruch</title>
	<link href="../../styles.css" rel="stylesheet">
</head>

<style type="text/css">
	.img_border {
		border: solid;
		vertical-align: top;
		margin: 10px;
	}
</style>

<body>
	<header>
		<h1>David J. Haruch</h1>
		<a href="https://davidharuch.github.io">Back to homepage</a>
	</header>

	<main>
		<h2>Voice Coil Motor Back Iron Optimization</h2>
		<h4>Updated 12-15-2023</h4>
    
    <p>Voice coil motors are used in various industries for positioning, force control, etc. In hard drives, a rotary voice coil motor is used to position the actuator arm. In semiconductor manufacturing capital equipment rotary and linear voice coils are commonly used for high bandwidth, short travel Z axis positioning above a wafer or device. The principle of operation/construnction is to place a set of current carrying wires in a magnetic field generated by permanent magnets. This causes a lorentz force to be exerted on the coil (and a reaction force on the magnet assembly). Control over force (acceleration) is easily attained by a simple amplifier and high precision closed loop position or velocity control is possible with a displacement transducer (encoder, interferometer, etc.).</p>


    <img src="VCM_example.png" width="65%">
    <img src="wire_bonder_Z_etel.png" width="60%">
    <img src="VCM_hard_drive.png" width="30%">
		
	<p>In positioning stages, voice coil motors are typically carried by other motion axes, therefore it is desirable to reduce the mass of the voice coil or to maximize the force constant/mass ratio. One way to do this is by optimization of the magnet array geometry (hard and soft magnetic materials have high density).</p>

	<p>A typical voice coil motor arrangement cross section using a so called "Halbach" array is shown below modeled in FEMM. There are 3 components to a common commercial voice coil motor.</p>
	<img src="VCM_topology.png" width="40%">
	<img src="VCM_flux.png" width="45%">
	<ol>
		<li>Coil (commonly copper, aluminum, or copper-clad aluminum)</li>
		<li>"Hard magnetic" Permanent Magnets (commonly strong grade Neodymium such as N50 or N52)</li>
		<li>"Soft magnetic" Back Iron (commonly a low carbon steel such as AISI1010)</li>
	</ol>

	<p>The parameters for the above motor can be seen in the table below.</p>

	<h4>Input VCM Parameters</h4>
	<table>
	    <tr>
	        <td>problem_thickness</td>
	        <td>25</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>current</td>
	        <td>1</td>
	        <td>FLOAT</td>
	        <td>Amps </td>
	    </tr>
	    <tr>
	        <td>no_turns</td>
	        <td>100</td>
	        <td>INT</td>
	        <td>N/A </td>
	    </tr>
	    <tr>
	        <td>coil_thickness</td>
	        <td>5.25</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>coil_height</td>
	        <td>8</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>coil_gap</td>
	        <td>12</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>air_gap</td>
	        <td>0.8</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>boundary_x</td>
	        <td>100</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>boundary_y</td>
	        <td>50</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>magnet_thickness</td>
	        <td>9</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>halbach1_height</td>
	        <td>6</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>normal1_height</td>
	        <td>15</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>backiron_thickness</td>
	        <td>5</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>backiron_height</td>
	        <td>36</td>
	        <td>FLOAT</td>
	        <td>mm </td>
	    </tr>
	    <tr>
	        <td>magnet_density</td>
	        <td>7450</td>
	        <td>FLOAT</td>
	        <td>kg/m^3 </td>
	    </tr>
	    <tr>
	        <td>backiron_density</td>
	        <td>7870</td>
	        <td>FLOAT</td>
	        <td>kg/m^3</td>
	    </tr>
	</table>

	<p>The flux density in the back-iron is not consistent over its height. Therefore, the un-used material could be removed to reduce the mass of the motor without impacting the force output in the shown coil position.</p>

	<p>Observing the flux density at various positions along the back iron appears to be an appropimately linear relationship between flux density and position. From this it appears plausible that a triangular shaped cut could correspond well with good material to remove. Arbitrary triangular cuts can also easily be machined with a form cutter on a CNC milling machine at reasonable cost, or the back iron could be cast by investment, sand, or die.</p>

	<h4>Cut geometry figure</h4>
	<img src="cut_geometry_figure.png" width="48%" style="vertical-align: middle">

	<p>Consider an optimization problem where it is desired to reduce the back iron mass (over an existing motor) with at maximum a 1% change in the force constant of the motor (the force constant must be at minimum 99% of an un-cut back iron motor) with a minimum back iron thickness of 2mm. This is a common design task when improving existing machinery where the packaging space may be fixed and there may be fabrication constraints on thin walls. <b>By exploring the design space, the optimal design is reached with a 3mm cut at a 12deg angle (of the points on the 0.99 line, 3mm, 12deg is the lightest back iron that reduces total magnet+backiron mass by 8.7%)</b>. </p>

	<img src="VCM_optimized_3mmCut_12degAngle_99%Kf.png" width="48%" style="vertical-align: middle">
	<img src="VCM_optimized_3mmCut_12degAngle_matlab.png" width="48%" style="vertical-align: middle">

	<p>Now consider the same optimization problem with a minimum back iron thickness of 0.25mm (0.010"). The optimal back iron cut thickness is now 4.75mm at an angle of 21.75deg as it has 99% of the original force constant and reduces mass by 11.6% (improved over the 2mm thickness limited optimized result, therefore a minimum thickness does restrict maximum performance).</p>

	<img src="VCM_kf_optimized_0p25min.png" width="48%" style="vertical-align: middle">
	<img src="VCM_mass_optimized_0p25min.png" width="48%" style="vertical-align: middle">

	<p>Overlaying the flux density in the air gap of the original design, the first optimized design, and the second optimized design shows the results graphically. The 99% minimum kf follows well with flux density.</p>

	<img src="3concepts_flux_density_vs_pos.png" width="48%" style="vertical-align: middle">
	<img src="3concepts_flux_density_vs_pos_inset.png" width="48%" style="vertical-align: middle">

	<p>Viewing the entire flux density plot shows, on the optimized designs, the flux density in the back iron is consistent compared to variable on the baseline. (a) = Baseline; (b) = optimization 2mm min back iron thickness; (c) optimization 0.25mm minimum thickness</p>

	<img src="baseline_0to2T.png" width="32%">
	<img src="optim1_0to2T.png" width="29.7%">
	<img src="optim2_0to2T.png" width="32%">

	<img src="mass_bar_chart.png" width="49.4%">
	<img src="kf_bar_chart.png" width="49.4%">

	<p>The downsides of this option are the additional cost of fabrication to make a unique shape back iron. Instead of a simple plate that could be waterjet, plasma, or laser cut is now a complex shape that must be machined or cast into the shape. Additionally engineering resources are needed to perform the analysis/optimization for the specific application. However for high performance applications these are commonly the tradeoffs needed to meet specification.</p>

	<h3>MATLAB Codes</h3>
	<p>MATLAB and FEMM codes for the optimization and figures can be found below. The scripts assume FEMM is correctly installed and added to the MATLAB path</p>
	<p><a href="17DEC2023_VCM.zip">MATLAB FEMM Codes</a></p>

	<h3>Comparison to patent literature and academic literature</h3>
	<p>This type of design optimization was rare to find in textbooks and the literature, but appears common in industry from the patent literature</p>

	<img src="ASML_US20030052548A1.png" width="45%" class="img_border">
	<img src="zhang_et_al_IEEE_fig14.png" width="45%" class="img_border">
	<img src="anorad_US7291953B1.png" width="45%" class="img_border">
	<img src="ASML_US20060082753A1.png" width="45%" class="img_border">

	<ul>
		<li><a href="https://patents.google.com/patent/US20030052548A1">https://patents.google.com/patent/US20030052548A1</a></li>
		<li><a href="https://patents.google.com/patent/US7291953B1">https://patents.google.com/patent/US7291953B1</a></li>
		<li><a href="https://patents.google.com/patent/US20060082753A1">https://patents.google.com/patent/US20060082753A1</a></li>
		<li><a href="https://doi.org/10.1109/TIE.2014.2365758">H. Zhang, B. Kou, H. Zhang and Y. Jin, "A Three-Degree-of-Freedom Short-Stroke Lorentz-Force-Driven Planar Motor Using a Halbach Permanent-Magnet Array With Unequal Thickness," in IEEE Transactions on Industrial Electronics, vol. 62, no. 6, pp. 3640-3650, June 2015</a></li>
		
	</ul>

	<h3>Further research</h3>
	<ul>
		<li>Investigate how these results depend on the nonlinear BH curve for different materials (i.e. nickel or cobalt alloys) or lot to lot variability in magnetic properties of common soft magnetic materials</li>
		<li>Investigate how to optimize the geometry for force constant over an expected travel range</li>
		<li>Determine the true optimal back iron shape that maximizes force constant/mass (free of constraint on shape or minimum dimensions)</li>
		<li>Applying similar shape optimization to the permanent magnets (shape, size, direction)</li>
		<li>Comparing the simulation results to experiment</li>
		<li>Ensure the reduction in back-iron material does not significantly increase deflection or stress in the motor from magnetic attractive force (hundreds of newtons) in mechanical FEA software (NASTRAN, etc...)</li>
		<li>Apply faster optimization routines (GA, gradient methods, etc...)</li>
	</ul>

	</main>
</body>

</html>
